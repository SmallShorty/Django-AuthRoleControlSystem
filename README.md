# –û –ø—Ä–æ–µ–∫—Ç–µ

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ—Å—É—Ä—Å–∞–º, –Ω–µ –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
* **–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Ç–æ–∫–µ–Ω–æ–≤**: –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ `set_auth_cookies` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ JWT. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `samesite='Lax'`, `path='/'` –∏ `httponly=True` –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É.
* **–°–ª–æ–π AuthService**: –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, —Ä–æ—Ç–∞—Ü–∏—è) –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π, –∏–∑–æ–ª–∏—Ä—É—è –µ—ë –æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤.
* **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–π**: –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ (`logout`) Refresh-—Ç–æ–∫–µ–Ω –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–Ω–æ—Å–∏—Ç—Å—è –≤ `blacklist`.
* **Soft Delete (–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)**: –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `is_active=False`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ä–∞–∑–ª–æ–≥–∏–Ω–∏–≤–∞–µ—Ç—Å—è, –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥ –¥–ª—è –Ω–µ–≥–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ `AuthService`.

###  –ú–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º
–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–ª–∞—Å—Å–∞—Ö `BasePermission` –≤ DRF. 

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
| :--- | :--- | :--- |
| `read` | –î–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö** —Ä–µ—Å—É—Ä—Å–æ–≤. | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã. |
| `read_all` | –î–æ—Å—Ç—É–ø –Ω–∞ —á—Ç–µ–Ω–∏–µ **–≤—Å–µ—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞. | –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑—ã –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. |
| `create` | –ü—Ä–∞–≤–æ –Ω–∞ **—Å–æ–∑–¥–∞–Ω–∏–µ** –Ω–æ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞. | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç. |
| `update` | –ü—Ä–∞–≤–æ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ **—Å–≤–æ–∏—Ö** –∑–∞–ø–∏—Å–µ–π. | –ê–≤—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç —Å–≤–æ–µ–≥–æ –ø–æ—Å—Ç–∞. |
| `update_all` | –ü—Ä–∞–≤–æ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ **–ª—é–±—ã—Ö** –∑–∞–ø–∏—Å–µ–π. | –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏—Ç—å –ª—é–±–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç. |
| `delete` | –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ **—Å–≤–æ–∏—Ö** –∑–∞–ø–∏—Å–µ–π. | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–π –∑–∞–ø–∏—Å—å. |
| `delete_all` | –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ **–ª—é–±—ã—Ö** –∑–∞–ø–∏—Å–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ. | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ—á–∏—â–∞—Ç—å —Å–∏—Å—Ç–µ–º—É. |

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç Mock-–æ–±—ä–µ–∫—Ç–æ–≤ –∫ —Ä–µ–∞–ª—å–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º –ë–î, –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–µ `owner` (FK –Ω–∞ `User`). –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Permission-–∫–ª–∞—Å—Å–∞—Ö –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
1. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (`_all`)**: –ï—Å–ª–∏ —É —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ `read_all` –∏–ª–∏ `update_all`, –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –∑–∞–ø–∏—Å—è–º.
2. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥ `read` –∏–ª–∏ `update`, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä:
   ```python
   # –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –≤ —Å–ª–æ–µ –¥–æ—Å—Ç—É–ø–∞
   queryset.filter(owner=request.user)
    ```
## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ –±–∞–∑–µ JWT-—Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ HttpOnly Cookies: —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –±—É–¥—É—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö JavaScript-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Ç–µ–º —Å–∞–º—ã–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞—è —Ä–∏—Å–∫ –∏—Ö –∫—Ä–∞–∂–∏ —á–µ—Ä–µ–∑ XSS-–∞—Ç–∞–∫–∏

## üõ† API Endpoints

### 1. –ê–∫–∫–∞—É–Ω—Ç –∏ —Å–µ—Å—Å–∏–∏ (`api/account/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| :--- | :--- | :--- | :--- |
| `POST` | `/register/` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥. |
| `POST` | `/login/` | –í—Ö–æ–¥ | –ü—Ä–æ–≤–µ—Ä–∫–∞ `is_active`, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Cookies. |
| `POST` | `/logout/` | –í—ã—Ö–æ–¥ | –û—á–∏—Å—Ç–∫–∞ Cookies, Blacklist —Ç–æ–∫–µ–Ω–∞. |
| `GET` | `/me/` | –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ. |

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∏ —Ä–æ–ª–µ–π (`api/access/`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `GET` | `/my-roles/` | –°–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. |

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
[
    {
        "name": "–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞",
        "slug": "content-manager",
        "allowed_actions": [
            {
                "name": "–°—Ç–∞—Ç—å–∏",
                "slug": "articles",
                "permissions": {
                    "read": true,
                    "read_all": true,
                    "create": true,
                    "update": true,
                    "update_all": false,
                    "delete": false,
                    "delete_all": false
                }
            },
            {
                "name": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",
                "slug": "comments",
                "permissions": {
                    "read": true,
                    "read_all": false,
                    "create": true,
                    "update": false,
                    "update_all": false,
                    "delete": true,
                    "delete_all": false
                }
            }
        ]
    },
    {
        "name": "–ê–Ω–∞–ª–∏—Ç–∏–∫",
        "slug": "analyst",
        "allowed_actions": [
            {
                "name": "–û—Ç—á–µ—Ç—ã",
                "slug": "reports",
                "permissions": {
                    "read": true,
                    "read_all": true,
                    "create": false,
                    "update": false,
                    "update_all": false,
                    "delete": false,
                    "delete_all": false
                }
            }
        ]
    }
]
```

# –î–µ–ø–ª–æ–π
```python
python -m venv venv
source venv/bin/activate  # –î–ª—è Linux/macOS
# –∏–ª–∏
venv\Scripts\activate     # –î–ª—è Windows
pip install -r requirements.txt
cd AuthRoleControlSystem
python manage.py migrate
python manage.py runserver
```
